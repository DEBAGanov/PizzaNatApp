# –¢–ó –¥–ª—è Backend –∫–æ–º–∞–Ω–¥—ã: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SMS –∏ Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –û–±–∑–æ—Ä

–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –¥–≤–∞ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π backend PizzaNat:
1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ SMS –∫–æ–¥** (–∏—Å–ø–æ–ª—å–∑—É—è Exolve SMS API)
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram** (–∏—Å–ø–æ–ª—å–∑—É—è Telegram Bot API)

## 1. SMS –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### 1.1 –û–±—â–∞—è —Å—Ö–µ–º–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –í–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ SMS ‚Üí –í–≤–æ–¥ –∫–æ–¥–∞ ‚Üí –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```

### 1.2 –¢—Ä–µ–±—É–µ–º—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### POST `/api/auth/phone/send-code`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ SMS –∫–æ–¥–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞

**Request Body:**
```json
{
  "phoneNumber": "+79991234567"
}
```

**Response 200:**
```json
{
  "success": true,
  "message": "SMS –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω",
  "expiresAt": "2024-12-20T15:30:00Z",
  "codeLength": 4
}
```

**Response 400:**
```json
{
  "success": false,
  "error": "INVALID_PHONE_NUMBER",
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞"
}
```

**Response 429:**
```json
{
  "success": false,
  "error": "RATE_LIMIT_EXCEEDED",
  "message": "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥",
  "retryAfter": 60
}
```

#### POST `/api/auth/phone/verify-code`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ SMS –∫–æ–¥–∞ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**Request Body:**
```json
{
  "phoneNumber": "+79991234567",
  "code": "1234"
}
```

**Response 200:**
```json
{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 123,
    "phoneNumber": "+79991234567",
    "firstName": "–ò–≤–∞–Ω",
    "lastName": "–ò–≤–∞–Ω–æ–≤",
    "email": null,
    "isPhoneVerified": true,
    "createdAt": "2024-12-20T12:00:00Z"
  }
}
```

**Response 400:**
```json
{
  "success": false,
  "error": "INVALID_CODE",
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –∏–ª–∏ –∫–æ–¥ –∏—Å—Ç–µ–∫"
}
```

### 1.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Exolve SMS API

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.exolve.ru/docs/ru/api-reference/sms-api/

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
- **API URL**: `https://api.exolve.ru/messaging/v1/SendSMS`
- **Authorization**: `Bearer YOUR_API_KEY`
- **–ú–µ—Ç–æ–¥**: POST

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ Exolve:**
```json
{
  "number": "PizzaNat",
  "destination": "+79991234567",
  "text": "–í–∞—à –∫–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ PizzaNat: 1234. –ù–µ —Å–æ–æ–±—â–∞–π—Ç–µ –µ–≥–æ –Ω–∏–∫–æ–º—É!"
}
```

### 1.4 –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã SMS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞** –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É SMS –∫–æ–¥–∞
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞** —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ñ–æ—Ä–º–∞—Ç +7XXXXXXXXXX)
3. **Rate limiting**: –º–∞–∫—Å–∏–º—É–º 3 SMS –≤ —á–∞—Å –Ω–∞ –Ω–æ–º–µ—Ä
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è 4-–∑–Ω–∞—á–Ω–æ–≥–æ –∫–æ–¥–∞** (—Ü–∏—Ñ—Ä—ã 0-9)
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–¥–∞** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å TTL 10 –º–∏–Ω—É—Ç
6. **–û—Ç–ø—Ä–∞–≤–∫–∞ SMS** —á–µ—Ä–µ–∑ Exolve API
7. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è** –Ω–æ–º–µ—Ä–∞ –∏ –∫–æ–¥–∞
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞** —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞
3. **–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
4. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞**
6. **–£–¥–∞–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞**

### 1.5 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `sms_codes`

```sql
CREATE TABLE sms_codes (
    id BIGSERIAL PRIMARY KEY,
    phone_number VARCHAR(20) NOT NULL,
    code VARCHAR(4) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP NOT NULL,
    used BOOLEAN DEFAULT FALSE,
    attempts INTEGER DEFAULT 0,

    INDEX idx_phone_number (phone_number),
    INDEX idx_expires_at (expires_at)
);
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `users`

```sql
ALTER TABLE users ADD COLUMN phone_number VARCHAR(20) UNIQUE;
ALTER TABLE users ADD COLUMN is_phone_verified BOOLEAN DEFAULT FALSE;
ALTER TABLE users ALTER COLUMN email DROP NOT NULL; -- —Ç–µ–ª–µ—Ñ–æ–Ω –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ email
```

## 2. Telegram –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### 2.1 –û–±—â–∞—è —Å—Ö–µ–º–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è auth_token ‚Üí –û—Ç–∫—Ä—ã—Ç–∏–µ Telegram ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```

### 2.2 –¢—Ä–µ–±—É–µ–º—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### POST `/api/auth/telegram/init`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**Request Body:**
```json
{
  "deviceId": "android_device_123" // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
}
```

**Response 200:**
```json
{
  "success": true,
  "authToken": "tg_auth_abc123def456",
  "telegramBotUrl": "https://t.me/pizzanat_bot?start=tg_auth_abc123def456",
  "expiresAt": "2024-12-20T15:30:00Z"
}
```

#### GET `/api/auth/telegram/status/{authToken}`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**Response 200 (–Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ):**
```json
{
  "success": true,
  "status": "PENDING",
  "message": "–û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤ Telegram"
}
```

**Response 200 (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ):**
```json
{
  "success": true,
  "status": "CONFIRMED",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 123,
    "telegramId": 987654321,
    "username": "@john_doe",
    "firstName": "–ò–≤–∞–Ω",
    "lastName": "–ò–≤–∞–Ω–æ–≤",
    "email": null,
    "isTelegramVerified": true,
    "createdAt": "2024-12-20T12:00:00Z"
  }
}
```

**Response 400:**
```json
{
  "success": false,
  "error": "INVALID_TOKEN",
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –∏—Å—Ç–µ–∫—à–∏–π —Ç–æ–∫–µ–Ω"
}
```

### 2.3 Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://core.telegram.org/api#tdlib-build-your-own-telegram

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–æ—Ç—É:**
- **–ò–º—è –±–æ—Ç–∞**: `@pizzanat_bot` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–µ)
- **–ö–æ–º–∞–Ω–¥—ã**: `/start`, `/auth`, `/help`
- **Webhook URL**: `https://your-backend.com/api/telegram/webhook`

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥:**

```
/start tg_auth_abc123def456
```

–û—Ç–≤–µ—Ç –±–æ—Ç–∞:
```
üçï –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PizzaNat!

–í—ã —Ö–æ—Ç–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏?

[‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å] [‚ùå –û—Ç–º–µ–Ω–∞]
```

### 2.4 –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ auth_token** (UUID + –ø—Ä–µ—Ñ–∏–∫—Å)
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å TTL 10 –º–∏–Ω—É—Ç
3. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏** –Ω–∞ Telegram –±–æ—Ç–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
4. **–û–∂–∏–¥–∞–Ω–∏–µ** –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
5. **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram API
6. **–ü–æ–∏—Å–∫/—Å–æ–∑–¥–∞–Ω–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
7. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–∞**

### 2.5 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞ `telegram_auth_tokens`

```sql
CREATE TABLE telegram_auth_tokens (
    id BIGSERIAL PRIMARY KEY,
    auth_token VARCHAR(50) UNIQUE NOT NULL,
    telegram_id BIGINT,
    telegram_username VARCHAR(100),
    telegram_first_name VARCHAR(100),
    telegram_last_name VARCHAR(100),
    status VARCHAR(20) DEFAULT 'PENDING', -- PENDING, CONFIRMED, EXPIRED
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP NOT NULL,
    confirmed_at TIMESTAMP,

    INDEX idx_auth_token (auth_token),
    INDEX idx_expires_at (expires_at)
);
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `users`

```sql
ALTER TABLE users ADD COLUMN telegram_id BIGINT UNIQUE;
ALTER TABLE users ADD COLUMN telegram_username VARCHAR(100);
ALTER TABLE users ADD COLUMN is_telegram_verified BOOLEAN DEFAULT FALSE;
```

## 3. –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 3.1 –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **Rate Limiting**:
   - SMS: –º–∞–∫—Å–∏–º—É–º 3 —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Å –Ω–∞ –Ω–æ–º–µ—Ä
   - Telegram: –º–∞–∫—Å–∏–º—É–º 5 —Ç–æ–∫–µ–Ω–æ–≤ –≤ —á–∞—Å –Ω–∞ IP

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**:
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - CSRF –∑–∞—â–∏—Ç–∞ –¥–ª—è Telegram webhook

3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –û—à–∏–±–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
   - –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### 3.2 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**Environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**

```bash
# Exolve SMS
EXOLVE_API_URL=https://api.exolve.ru/messaging/v1
EXOLVE_API_KEY=your_api_key_here
EXOLVE_SENDER_NAME=PizzaNat

# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_BOT_USERNAME=pizzanat_bot
TELEGRAM_WEBHOOK_URL=https://your-backend.com/api/telegram/webhook

# SMS Settings
SMS_CODE_LENGTH=4
SMS_CODE_TTL_MINUTES=10
SMS_RATE_LIMIT_PER_HOUR=3

# Telegram Settings
TELEGRAM_AUTH_TOKEN_TTL_MINUTES=10
TELEGRAM_RATE_LIMIT_PER_HOUR=5
```

### 3.3 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞:**

1. **Exolve API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
2. **Telegram API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**: Fallback –Ω–∞ polling –≤–º–µ—Å—Ç–æ webhook
3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ SMS**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
4. **–ò—Å—Ç–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ expired –∑–∞–ø–∏—Å–µ–π

### 3.4 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö SMS –≤ –¥–µ–Ω—å
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ Exolve –∏ Telegram API
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø–æ —Ç–∏–ø–∞–º

## 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 4.1 Unit —Ç–µ—Å—Ç—ã

- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ SMS –∫–æ–¥–æ–≤
- –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- JWT —Ç–æ–∫–µ–Ω—ã

### 4.2 Integration —Ç–µ—Å—Ç—ã

- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª SMS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–Ω–µ—à–Ω–∏—Ö API

### 4.3 –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
- Mock Exolve API –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –¢–µ—Å—Ç–æ–≤—ã–π Telegram –±–æ—Ç –¥–ª—è staging
- –¢–µ—Å—Ç–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

## 5. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 5.1 Staging

1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ Telegram –±–æ—Ç–∞
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ Exolve
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook endpoints

### 5.2 Production

1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è production Telegram –±–æ—Ç–∞
2. –ü–æ–ª—É—á–µ–Ω–∏–µ production API –∫–ª—é—á–µ–π Exolve
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –¥–ª—è webhook
4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## 6. –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**

- **SMS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: 3-4 –¥–Ω—è
- **Telegram –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: 4-5 –¥–Ω–µ–π
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞**: 2-3 –¥–Ω—è
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –¥–µ–ø–ª–æ–π**: 1 –¥–µ–Ω—å

**–û–±—â–µ–µ –≤—Ä–µ–º—è**: 10-13 –¥–Ω–µ–π

## 7. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ SMS –∫–æ–¥
2. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram
3. ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ edge cases
4. ‚úÖ –°–æ–±–ª—é–¥–µ–Ω–∏–µ rate limiting
5. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
6. ‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
7. ‚úÖ Unit –∏ integration —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É
8. ‚úÖ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:**
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç
- –¢—Ä–µ–±—É–µ—Ç—Å—è backward compatibility —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- Mobile –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ –≥–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —ç—Ç–∏–º–∏ API