# ‚úÖ –†–ï–®–ï–ù–û: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å backend deliveryType

**–î–∞—Ç–∞**: 30.01.2025 (–û–±–Ω–æ–≤–ª–µ–Ω–æ)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –†–ï–®–ï–ù–û  
**–°—Ç–∞—Ç—É—Å**: –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –ø–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å backend  

## üìã –ü—Ä–æ–±–ª–µ–º–∞ (–†–ï–®–ï–ù–ê)

~~–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ `CreateOrderRequest`:~~
- ~~–û—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å: `deliveryMethod` —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ ("DELIVERY", "PICKUP")~~  
- ~~Backend –æ–∂–∏–¥–∞–ª: `deliveryType` —Å —Ä—É—Å—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ ("–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º", "–°–∞–º–æ–≤—ã–≤–æ–∑")~~

**‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û**: –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–æ–ª—è –∏ –∑–Ω–∞—á–µ–Ω–∏—è.

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –í –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û:

```json
POST /api/v1/orders
Content-Type: application/json

{
  "deliveryAddress": "—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10, –∫–≤. 5",
  "contactName": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
  "contactPhone": "+79001234567",
  "comment": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –°–ë–ü",
  "paymentMethod": "SBP",
  "deliveryType": "–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º"  ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û! (—Ä—É—Å—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)
}
```

### –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö ‚úÖ –î–û–õ–ñ–ù–û –†–ê–ë–û–¢–ê–¢–¨:

**–¢–µ–ø–µ—Ä—å –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

```
| order_id | delivery_type      | delivery_cost |
|----------|-------------------|---------------|
| XX       | –î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º | 200.00        |
| XX       | –î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º | 200.00        |
| XX       | –°–∞–º–æ–≤—ã–≤–æ–∑         | 0.00          |
```

**Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –ü–æ–ª—É—á–∞–µ—Ç `deliveryType: "–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º"` 
- –í—ã–∑—ã–≤–∞–µ—Ç `deliveryZoneService.calculateDelivery()` –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç `order.setDeliveryType()` –∏ `order.setDeliveryCost()`

## ‚úÖ Backend —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

**Backend –∫–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤!** –ê–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ OrderService —É–∂–µ:

### 1. DTO –≥–æ—Ç–æ–≤ ‚úÖ
```java
// CreateOrderRequest —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:
@Size(max = 100, message = "–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 100 —Å–∏–º–≤–æ–ª–æ–≤")
private String deliveryType; // "–°–∞–º–æ–≤—ã–≤–æ–∑" –∏–ª–∏ "–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º"
```

### 2. OrderService –≥–æ—Ç–æ–≤ ‚úÖ
```java
// OrderService.createOrder() —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:
String deliveryType = request.getDeliveryType() != null ? request.getDeliveryType() : "–°–∞–º–æ–≤—ã–≤–æ–∑";

// –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏:
if (request.isDeliveryByCourier() && request.getDeliveryAddress() != null) {
    DeliveryCalculationResult result = deliveryZoneService.calculateDelivery(...);
    deliveryCost = result.getDeliveryCost();
}

// –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Order:
order.setDeliveryType(deliveryType);
order.setDeliveryCost(deliveryCost);
```

### 3. Entity –≥–æ—Ç–æ–≤ ‚úÖ
```java
// Order entity —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è:
private String deliveryType;
private BigDecimal deliveryCost;
```

**üéØ –ò–¢–û–ì**: –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ backend –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

| Mobile App Value | Backend DB Value       | Cost  |
|------------------|------------------------|-------|
| "DELIVERY"       | "–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º"    | 200.0 |
| "PICKUP"         | "–°–∞–º–æ–≤—ã–≤–æ–∑"           | 0.0   |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π:**
   ```bash
   curl -X POST https://api.dimbopizza.ru/api/v1/orders \
     -H "Content-Type: application/json" \
     -H "Authorization: Bearer $TOKEN" \
     -d '{
       "deliveryAddress": "—Ç–µ—Å—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å",
       "contactName": "–¢–µ—Å—Ç",
       "contactPhone": "+79001234567",
       "paymentMethod": "CASH",
       "deliveryMethod": "DELIVERY"
     }'
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
   ```sql
   SELECT id, delivery_type, delivery_cost 
   FROM orders 
   ORDER BY created_at DESC 
   LIMIT 5;
   ```

   **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   | id | delivery_type      | delivery_cost |
   |----|-------------------|---------------|
   | XX | –î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º | 200.00        |
   ```

## üî• –í–ª–∏—è–Ω–∏–µ –Ω–∞ –Æ–ö–∞—Å—Å—É ‚úÖ –†–ï–®–ï–ù–û

**–¢–µ–ø–µ—Ä—å –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** Backend –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `deliveryType` –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É —á–µ—Ä–µ–∑ –∑–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π flow:**
1. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –ü–µ—Ä–µ–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—É–º–º—É —Ç–æ–≤–∞—Ä–æ–≤ (1‚ÇΩ) –≤ –Æ–ö–∞—Å—Å—É
2. **Backend**: –ü–æ–ª—É—á–∞–µ—Ç `deliveryType: "–î–æ—Å—Ç–∞–≤–∫–∞ –∫—É—Ä—å–µ—Ä–æ–º"`
3. **Backend**: –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç `deliveryCost` —á–µ—Ä–µ–∑ `deliveryZoneService.calculateDelivery()`
4. **Backend**: –§–æ—Ä–º–∏—Ä—É–µ—Ç —á–µ–∫ –Æ–ö–∞—Å—Å—ã: —Ç–æ–≤–∞—Ä—ã 1‚ÇΩ + –¥–æ—Å—Ç–∞–≤–∫–∞ 200‚ÇΩ = 201‚ÇΩ
5. **–Æ–ö–∞—Å—Å–∞**: –û–±—â–∞—è —Å—É–º–º–∞ 1‚ÇΩ = –ß–µ–∫ 201‚ÇΩ ‚ùå **–°–¢–û–ü!**

**üö® –í–ù–ò–ú–ê–ù–ò–ï**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –µ—â–µ –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ - –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å—É–º–º—É —Ç–æ–≤–∞—Ä–æ–≤, –Ω–æ backend —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —á–µ–∫ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π. –°—É–º–º—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ú–æ–±–∏–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞**: –ì–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ  
**Backend –∫–æ–º–∞–Ω–¥–∞**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ `deliveryMethod`

---

**‚ö° –°–¢–ê–¢–£–°**: ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å backend –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞! –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞–µ—Ç `deliveryType` —Å —Ä—É—Å—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –û—Å—Ç–∞–ª–∞—Å—å –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å—É–º–º–∞–º–∏ –≤ –Æ–ö–∞—Å—Å–µ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞). 